<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Zhe Xu - Homepage</title>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-R2ZLMKHR2E"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-R2ZLMKHR2E');
  </script>

  <script>
    function loadWordCloud() {
      const traits = [
      ["Leader", 30],
      ["Instructor", 15],
      ["Connector", 25],
      ["Smart", 15],
      ["Mature", 20],
      ["Impact-Driven", 40],
      ["Resilience", 30],
      ["Passionate", 20],
      ["Faithful", 30],
      ["Confident", 20]
      ["Innovative", 15],
      ["Questioner", 30],
      ["Insightful", 40],
      ["Visionary", 20],
      ["Emotionally Stable", 25],
      ];

      const canvas = document.getElementById("word-cloud");
      
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      WordCloud(canvas, {
        list: traits, // 使用特性词语列表
        gridSize: Math.round(16 * window.innerWidth / 1024), // 网格大小，随屏幕变化调整
        weightFactor: window.innerWidth / 400, // 字体大小比例
        fontFamily: "Times, serif", // 字体
        color: function () {
          const colors = ["#1E88E5", "#F4511E", "#43A047", "#FB8C00", "#5E35B1"];
          return colors[Math.floor(Math.random() * colors.length)];
        },
        // backgroundColor: "#F0F4F8", // 柔和背景色
        rotateRatio: 0., // 减少文字旋转
        shuffle: true, // 随机排列单词
        shape: "circle", // 圆形布局
        drawOutOfBound: false,
      });
    }
  </script>

  <!-- 3D word cloud will be initialized dynamically -->

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Playfair+Display&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/wordcloud2.js/1.0.6/wordcloud2.min.js"></script>
  <script src="https://www.goat1000.com/tagcanvas.min.js"></script>
</head>

<body>

<div style="background-image:linear-gradient(rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0.5)),url('./media/occupacy.jpg');background-size: cover; background-position: center;padding-bottom: 20px;">
  <nav class="navbar is-primary">
    <div class="navbar-brand">
        <a class="navbar-item" href="/">
            <strong id="navbar-title">Hey! Joshua!</strong>
        </a>
    </div>

    <div id="top-navbar" class="navbar-menu">
        <div class="navbar-end">
            <a class="navbar-item" href="#about" id="navbar-about">
                About Me
            </a>
            <a class="navbar-item" href="#news" id="navbar-news">
                News
            </a>
            <a class="navbar-item" href="#publications" id="navbar-publications">
                Publications
            </a>
            <a class="navbar-item" href="#projects" id="navbar-projects">
                Projects
            </a>
            <a class="navbar-item" href="#blogs" id="navbar-blogs">
                Blogs
            </a>
            <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link" id="navbar-language">
                Language
              </a>
              <div class="navbar-dropdown">
                <!-- 语言按钮将动态生成 -->
              </div>
            </div>
        </div>
    </div>
  </nav>
  <div class="container has-text-centered">
    <div style="display: flex; justify-content: space-between; align-items: center; height: 300px;">
      <div style="flex: 1;display: flex; justify-content: center; align-items: center;">
        <div class="card-container">
          <!-- 卡片内容将动态生成 -->
      
          <!-- Arrow Buttons -->
          <button class="arrow-btn arrow-left" id="prev-btn">
            <i class="fas fa-arrow-left"></i>
          </button>
          <button class="arrow-btn arrow-right" id="next-btn">
            <i class="fas fa-arrow-right"></i>
          </button>
        </div>
      </div>
    
      <div style="flex: 1; display: flex; justify-content: center; align-items: center;">
        <figure class="image is-128x128 is-inline-block" style="width: 200px; height: 200px; margin: 0;">
          <img class="is-rounded" src="./media/personal.jpg" alt="Avatar" style="width: 100%; height: 100%;">
        </figure>
      </div>
  
      <div style="flex: 1; display: flex; justify-content: center; align-items: center;">
        <div id="canvas-container">
          <canvas id="word-cloud" width="400" height="300"></canvas>
          <ul id="tags">
            <!-- 词云标签将动态生成 -->
          </ul>
        </div>
      </div>
    </div>
    <h1 class="title is-size-3-tablet is-size-4-mobile" style="font-family: Futura;" id="main-title">
      Dream Big, Work Hard, Stay Humble.
    </h1>
    <p class="subtitle is-size-4-tablet is-size-5-mobile" style="font-family: Brush Script MT;" id="main-subtitle">
      ——Be Versatile, Be Great.
    </p>
    <div class="icon-box">
      <a href="https://github.com/Phospheneser" target="_blank">
          <i class="fab fa-github"></i>
      </a>
      <a href="https://scholar.google.com/citations?user=TSUlagkAAAAJ&hl=zh-CN" target="_blank">
          <i class="fas fa-graduation-cap"></i>
      </a>
      <a href="https://x.com/PhospheneserXu" target="_blank">
          <i class="fab fa-twitter"></i>
      </a>
      <a href="mailto:zxu24@m.fudan.edu.cn">
          <i class="fas fa-envelope"></i>
      </a>
  </div>
  </div>
</div>


<section class="section" name="sec-intro">
  <div class="container is-max-desktop">
    <div id="about">
      <h1 class="title is-3" id="about-title">🎄 About Me</h1>
    </div>
    <div>
      <p class="text-homepage-1" id="about-text1"></p>
      <p class="text-homepage-1" id="about-text2"></p>
    </div>
  </div>
  
</section>

<section class="section" name="sec-news">
  <div class="container is-max-desktop">
    <div id="news">
      <h1 class="title is-3" style="margin-bottom: 1ex;" id="news-title">🔥 News</h1>
      <div>
        <!-- 新闻内容将动态生成 -->
      </div>
    </div>
  </div>
</section>

<section class="section" name="sec-publications">
  <div class="container is-max-desktop">
    <div id="publications">
      <h1 class="title is-3" style="margin-bottom: 1ex;" id="publications-title">📑 Publications</h1>
      <div>
        <!-- 出版物内容将动态生成 -->
      </div>
    </div>
  </div>
</section>

<section class="section" name="sec-projects">
  <div class="container is-max-desktop">
    <div id="projects">
      <h1 class="title is-3" id="projects-title">⚙️ Projects</h1>
      <div>
        <!-- 项目内容将动态生成 -->
      </div>
    </div>
  </div>
</section>

<section class="section">
  <div class="container is-max-desktop">
    <div id="academic-service">
      <h1 class="title is-3" style="margin-bottom: 1em;" id="academic-service-title">Academic Service</h1>
      <div>
        <!-- 学术服务内容将动态生成 -->
      </div>
    </div>
  </div>
</section>

<section class="blogs">
  <div class="container is-max-desktop">
    <div id="blogs">
      <h1 class="title is-3" style="margin-bottom: 1ex;" id="blogs-title">Blogs</h1>
      <div>
        <!-- 博客内容将动态生成 -->
      </div>
    </div>
  </div>
</section>


<footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column">
        <div class="content has-text-centered">
          <p id="footer-text">
            Edit by Joshua@2025.9.27
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

</body>

<script>
let currentLang = localStorage.getItem('lang') || 'en';
let availableLanguages = ['en', 'zh', 'jp']; // 直接定义可用语言列表

async function loadContent(lang = currentLang) {

  // 加载所有数据文件
  const [webContentRes, projectsRes, publicationsRes, newsRes, blogsRes, academicServiceRes, cardsRes, wordcloudRes] = await Promise.all([
    fetch(`data/${lang}/web_content.json`),
    fetch(`data/${lang}/projects.json`),
    fetch(`data/${lang}/publications.json`),
    fetch(`data/${lang}/news.json`),
    fetch(`data/${lang}/blogs.json`),
    fetch(`data/${lang}/academic_service.json`),
    fetch(`data/${lang}/cards.json`),
    fetch(`data/${lang}/wordcloud.json`)
  ]);

  const webContent = await webContentRes.json();
  const projects = await projectsRes.json();
  const publications = await publicationsRes.json();
  const news = await newsRes.json();
  const blogs = await blogsRes.json();
  const academicService = await academicServiceRes.json();
  const cards = await cardsRes.json();
  const wordcloud = await wordcloudRes.json();

  const projectsList = projects.projects || [];
  const publicationsList = publications.publications || [];
  const newsList = news.news || [];
  const blogsList = blogs.blogs || [];
  const academicServiceList = academicService.academic_services || [];
  const cardsList = cards.cards || [];
  const wordcloudList = wordcloud.wordcloud || [];

  // 更新导航栏
  updateElement('#navbar-title', webContent.navbar_title);
  updateElement('#navbar-about', webContent.navbar_about);
  updateElement('#navbar-news', webContent.navbar_news);
  updateElement('#navbar-publications', webContent.navbar_publications);
  updateElement('#navbar-projects', webContent.navbar_projects);
  updateElement('#navbar-blogs', webContent.navbar_blogs);
  updateElement('#navbar-language', webContent.language);

  // 动态生成语言切换按钮
  generateLanguageButtons(webContent);

  // 更新标题和副标题
  updateElement('#main-title', webContent.title);
  updateElement('#main-subtitle', webContent.subtitle);

  // 更新 About 部分
  updateElement('#about-title', webContent.about_title);
  updateElement('#about-text1', webContent.about_text1);
  updateElement('#about-text2', webContent.about_text2);

  // 更新其他部分标题
  updateElement('#news-title', webContent.news_title);
  updateElement('#publications-title', webContent.publications_title);
  updateElement('#projects-title', webContent.projects_title);
  updateElement('#academic-service-title', webContent.academic_service_title);
  updateElement('#blogs-title', webContent.blogs_title);

  // 更新页脚
  updateElement('#footer-text', webContent.footer);

  // 动态生成新闻
  generateNews(newsList);

  // 动态生成出版物
  generatePublications(publicationsList);

  // 动态生成项目
  generateProjects(projectsList);

  // 动态生成学术服务
  generateAcademicService(academicServiceList);

  // 动态生成博客
  generateBlogs(blogsList);

  // 动态生成卡片
  generateCards(cardsList);

  // 初始化卡片切换功能
  initializeCardSlider();

  // 动态生成词云
  generateWordCloud(wordcloudList);

  // 确保词云正确初始化（首次加载或语言切换）
  setTimeout(() => {
    generateWordCloud(wordcloudList);
  }, 100);
}

function updateElement(selector, html) {
  const element = document.querySelector(selector);
  if (element) element.innerHTML = html;
}

function generateLanguageButtons(webContent) {
  const langDropdown = document.querySelector('#navbar-language').parentElement;
  const dropdown = langDropdown.querySelector('.navbar-dropdown');
  dropdown.innerHTML = '';
  availableLanguages.forEach(lang => {
    // 从当前语言的 webContent 中获取语言名称
    const langKeyMap = {
      'en': 'english',
      'zh': 'chinese',
      'jp': 'japanese'
    };
    const langKey = langKeyMap[lang];
    const langName = webContent[langKey] || lang;
    const button = document.createElement('a');
    button.className = 'navbar-item';
    button.onclick = () => switchLanguage(lang);
    button.innerHTML = langName;
    dropdown.appendChild(button);
  });
}

function generateNews(newsList) {
  console.log('Generating news with data:', newsList);
  const newsContainer = document.querySelector('#news');
  if (!newsContainer) {
    console.error('News container not found');
    return;
  }

  // 直接选择 #news 的第二个子元素（内容容器）
  const newsDiv = newsContainer.children[1];
  if (!newsDiv) {
    console.error('News content div not found');
    console.log('News container children:', newsContainer.children);
    return;
  }
  console.log('Found news div:', newsDiv);
  newsDiv.innerHTML = '';
  newsList.forEach(item => {
    const div = document.createElement('div');
    div.style.cssText = 'display: flex; justify-content: flex-start; align-items: center; margin-bottom: 15px;';
    div.innerHTML = `
      <span style="font-weight: bold; margin-right: 50px;">${item.date}</span>
      <span style="font-family: Georgia">${item.content}</span>
    `;
    newsDiv.appendChild(div);
  });
  console.log('News generation completed');
}

function generatePublications(publicationsList) {
  console.log('Generating publications with data:', publicationsList);
  const publicationsSection = document.querySelector('#publications');
  if (!publicationsSection) {
    console.error('Publications section not found');
    return;
  }

  // 直接选择 #publications 的第二个子元素（内容容器）
  const contentDiv = publicationsSection.children[1];
  if (!contentDiv) {
    console.error('Publications content div not found');
    console.log('Publications container children:', publicationsSection.children);
    return;
  }
  console.log('Found publications div:', contentDiv);

  // 移除现有 paper-container
  const existingContainers = contentDiv.querySelectorAll('.paper-container');
  existingContainers.forEach(c => c.remove());

  publicationsList.forEach(pub => {
    const paperContainer = document.createElement('div');
    paperContainer.className = 'paper-container';
    paperContainer.innerHTML = `
      <img src="${pub.image}" alt="Overview" class="paper-image">
      <div class="paper-content">
        <h2 class="paper-title">${pub.title}</h2>
        ${pub.conference ? `<p class="paper-conf">${pub.conference}</p>` : ''}
        <p class="paper-authors">${pub.authors}</p>
        <p class="paper-description">${pub.description}</p>
        <p>
          ${pub.links ? pub.links.map(link => `<a href="${link.url}" target="_blank" class="paper-link">[${link.type}]</a>`).join(' ') : ''}
        </p>
      </div>
    `;
    contentDiv.appendChild(paperContainer);
  });
  console.log('Publications generation completed');
}

function generateProjects(projectsList) {
  console.log('Generating projects with data:', projectsList);
  const projectsSection = document.querySelector('#projects');
  if (!projectsSection) {
    console.error('Projects section not found');
    return;
  }

  // 直接选择 #projects 的第二个子元素（内容容器）
  const contentDiv = projectsSection.children[1];
  if (!contentDiv) {
    console.error('Projects content div not found');
    console.log('Projects container children:', projectsSection.children);
    return;
  }
  console.log('Found projects div:', contentDiv);

  // 移除现有 paper-container
  const existingContainers = contentDiv.querySelectorAll('.paper-container');
  existingContainers.forEach(c => c.remove());

  projectsList.forEach(proj => {
    const paperContainer = document.createElement('div');
    paperContainer.className = 'paper-container';
    const imageHtml = proj.image ? `<img src="${proj.image}" alt="Overview" class="paper-image">` : '<div class="paper-image" style="background: #f0f0f0; display: flex; align-items: center; justify-content: center; height: 150px;">No Image</div>';
    paperContainer.innerHTML = `
      ${imageHtml}
      <div class="paper-content">
        <h2 class="paper-title" style="display: flex; justify-content: space-between; align-items: center;">
          ${proj.title}
          <span style="margin-left: auto; font-size: 16px;">${proj.date}</span>
        </h2>
        <p class="paper-authors">${proj.authors}</p>
        <p class="paper-description">${proj.description}</p>
        ${proj.links ? `<p>${proj.links.map(link => `<a href="${link.url}" target="_blank" class="paper-link">[${link.type}]</a>`).join(' ')}</p>` : ''}
      </div>
    `;
    contentDiv.appendChild(paperContainer);
  });
  console.log('Projects generation completed');
}

function generateBlogs(blogsList) {
  console.log('Generating blogs with data:', blogsList);
  const blogsSection = document.querySelector('#blogs');
  if (!blogsSection) {
    console.error('Blogs section not found');
    return;
  }

  // 直接选择 #blogs 的第二个子元素（内容容器）
  const contentDiv = blogsSection.children[1];
  if (!contentDiv) {
    console.error('Blogs content div not found');
    console.log('Blogs container children:', blogsSection.children);
    return;
  }
  console.log('Found blogs div:', contentDiv);

  // 清空现有内容
  contentDiv.innerHTML = '';

  // 可以在这里生成博客内容，如果有的话
  // 目前 blogs.json 是空的
  if (blogsList.length === 0) {
    contentDiv.innerHTML = '<p>No blog posts yet.</p>';
  } else {
    blogsList.forEach(blog => {
      const blogDiv = document.createElement('div');
      blogDiv.innerHTML = `
        <h3>${blog.title}</h3>
        <p>${blog.date}</p>
        <p>${blog.content}</p>
      `;
      contentDiv.appendChild(blogDiv);
    });
  }
  console.log('Blogs generation completed');
}

function generateAcademicService(academicServiceList) {
  console.log('Generating academic service with data:', academicServiceList);
  const academicServiceSection = document.querySelector('#academic-service');
  if (!academicServiceSection) {
    console.error('Academic service section not found');
    return;
  }

  // 直接选择 #academic-service 的第二个子元素（内容容器）
  const contentDiv = academicServiceSection.children[1];
  if (!contentDiv) {
    console.error('Academic service content div not found');
    console.log('Academic service container children:', academicServiceSection.children);
    return;
  }
  console.log('Found academic service div:', contentDiv);

  // 清空现有内容
  contentDiv.innerHTML = '';

  if (academicServiceList.length === 0) {
    contentDiv.innerHTML = '<p>No academic service records yet.</p>';
  } else {
    academicServiceList.forEach(service => {
      const serviceDiv = document.createElement('div');
      serviceDiv.style.cssText = 'display: flex; justify-content: flex-start; align-items: center; margin-bottom: 15px;';
      serviceDiv.innerHTML = `
        <span style="font-weight: bold; margin-right: 50px;">${service.type}</span>
        <span>${service.description}</span>
      `;
      contentDiv.appendChild(serviceDiv);
    });
  }
  console.log('Academic service generation completed');
}

function generateCards(cardsList) {
  console.log('Generating cards with data:', cardsList);
  const cardContainer = document.querySelector('.card-container');
  if (!cardContainer) {
    console.error('Card container not found');
    return;
  }

  // 只删除现有的卡片元素，保留按钮
  const existingCards = cardContainer.querySelectorAll('.card');
  existingCards.forEach(card => card.remove());

  if (cardsList.length === 0) {
    console.log('No cards data available');
    return;
  }

  // 只显示前5张卡片（如果有的话）
  const displayCards = cardsList.slice(0, 5);

  displayCards.forEach(card => {
    const cardDiv = document.createElement('div');
    cardDiv.className = 'card';
    cardDiv.innerHTML = `
      <div class="card-title">${card.title}</div>
      <div class="card-description">${card.description}</div>
    `;
    cardContainer.appendChild(cardDiv);
  });

  console.log('Cards generation completed');
}

function generateWordCloud(wordcloudList) {
  console.log('Generating word cloud with data:', wordcloudList);
  const tagsContainer = document.querySelector('#tags');
  if (!tagsContainer) {
    console.error('Word cloud tags container not found');
    return;
  }

  // 清空现有标签
  tagsContainer.innerHTML = '';

  if (wordcloudList.length === 0) {
    console.log('No word cloud data available');
    return;
  }

  wordcloudList.forEach(item => {
    const li = document.createElement('li');
    const a = document.createElement('a');
    a.href = '#';
    if (item.title) {
      a.title = item.title;
    }
    a.textContent = item.text;
    li.appendChild(a);
    tagsContainer.appendChild(li);
  });

  // 重新初始化TagCanvas词云
  try {
    if (typeof TagCanvas !== 'undefined') {
      TagCanvas.Start('word-cloud', 'tags', {
        textColour: '#FFFFFF',
        outlineColour: 'rgba(255, 255, 255, 0.5)',
        reverse: true,
        depth: 0.8,
        maxSpeed: 0.01,
        textFont: 'Papyrus, Arial, sans-serif',
        textHeight: 20,
        shuffleTags: true,
        initial: [0.3, 0.3],
        decel: 0.98,
        dragControl: true,
        weight: true,
        shape: 'spiral',
        tooltip: true
      });

      // 添加自定义的自动重新开始功能
      setupWordCloudAutoRestart();
    }
  } catch (e) {
    console.error('TagCanvas re-initialization error:', e);
  }

  console.log('Word cloud generation completed');
}

// 设置词云自动重新开始功能
function setupWordCloudAutoRestart() {
  const canvas = document.getElementById('word-cloud');
  if (!canvas) return;

  let restartTimer = null;
  let isUserInteracting = false;
  let lastInteractionTime = Date.now();
  let dragStartTime = 0;

  // 监听鼠标按下事件
  canvas.addEventListener('mousedown', function(e) {
    isUserInteracting = true;
    dragStartTime = Date.now();
    lastInteractionTime = Date.now();
    console.log('Word cloud interaction started');

    // 清除之前的定时器
    if (restartTimer) {
      clearTimeout(restartTimer);
    }
  });

  // 监听document的鼠标释放事件，确保即使鼠标在区域外释放也能检测到
  document.addEventListener('mouseup', function(e) {
    if (isUserInteracting) {
      isUserInteracting = false;
      lastInteractionTime = Date.now();
      const interactionDuration = Date.now() - dragStartTime;
      console.log('Word cloud interaction ended, duration:', interactionDuration + 'ms');

      // 如果交互时间很短（只是点击），立即重启
      if (interactionDuration < 100) {
        console.log('Short click detected, restarting immediately');
        setTimeout(() => startWordCloudRotation(), 100);
        return;
      }

      // 清除之前的定时器
      if (restartTimer) {
        clearTimeout(restartTimer);
      }

      // 5秒后重新开始转动
      restartTimer = setTimeout(function() {
        const timeSinceLastInteraction = Date.now() - lastInteractionTime;
        if (timeSinceLastInteraction >= 5000 && !isUserInteracting) {
          console.log('Word cloud restarting after 5 seconds of inactivity');
          startWordCloudRotation();
        }
      }, 5000);
    }
  });

  // 监听鼠标移动事件
  canvas.addEventListener('mousemove', function(e) {
    if (isUserInteracting) {
      lastInteractionTime = Date.now();
      // 清除定时器，因为用户正在交互
      if (restartTimer) {
        clearTimeout(restartTimer);
        restartTimer = setTimeout(function() {
          const timeSinceLastInteraction = Date.now() - lastInteractionTime;
          if (timeSinceLastInteraction >= 5000 && !isUserInteracting) {
            console.log('Word cloud restarting after 5 seconds of inactivity');
            startWordCloudRotation();
          }
        }, 5000);
      }
    }
  });

  // 监听鼠标离开事件
  canvas.addEventListener('mouseleave', function() {
    // 鼠标离开时不改变isUserInteracting状态，让document的mouseup事件处理
    console.log('Mouse left word cloud area');
  });

  // 监听鼠标进入事件
  canvas.addEventListener('mouseenter', function() {
    // 如果鼠标进入时还在交互状态（说明鼠标在区域外释放了）
    if (!isUserInteracting && Date.now() - lastInteractionTime < 5000) {
      isUserInteracting = true;
      lastInteractionTime = Date.now();

      // 鼠标重新进入时，清除定时器，因为用户回来了
      if (restartTimer) {
        clearTimeout(restartTimer);
        restartTimer = null;
        console.log('Mouse entered word cloud area, timer cleared');
      } else {
        console.log('Mouse entered word cloud area');
      }
    }
  });
}

// 启动词云转动（逐步加速）
function startWordCloudRotation() {
  if (typeof TagCanvas === 'undefined') return;

  try {
    const canvas = document.getElementById('word-cloud');
    if (canvas) {
      // 尝试重新开始TagCanvas动画
      if (canvas.tc) {
        // 重新设置动画状态
        canvas.tc.animating = true;
        canvas.tc.active = true;

        // 给所有标签添加随机速度
        if (canvas.tc.taglist && canvas.tc.taglist.length > 0) {
          canvas.tc.taglist.forEach(function(tag) {
            tag.vx = (Math.random() - 0.5) * 0.02;
            tag.vy = (Math.random() - 0.5) * 0.02;
            tag.va = (Math.random() - 0.5) * 0.02;
          });
        }

        // 强制重绘
        if (canvas.tc.Draw) {
          canvas.tc.Draw();
        }
        console.log('Word cloud rotation restarted with velocity reset');
      } else {
        // 如果tc对象不存在，重新初始化
        TagCanvas.Start('word-cloud', 'tags', {
          textColour: '#FFFFFF',
          outlineColour: 'rgba(255, 255, 255, 0.5)',
          reverse: true,
          depth: 0.8,
          maxSpeed: 0.01,
          textFont: 'Papyrus, Arial, sans-serif',
          textHeight: 20,
          shuffleTags: true,
          initial: [0.3, 0.3],
          decel: 0.98,
          dragControl: true,
          weight: true,
          shape: 'spiral',
          tooltip: true
        });
        console.log('Word cloud re-initialized');
      }
    }
  } catch (e) {
    console.error('Error restarting word cloud rotation:', e);
  }
}

function switchLanguage(lang) {
  localStorage.setItem('lang', lang);
  loadContent(lang);
}

// 初始化卡片切换功能
function initializeCardSlider() {
  const cards = document.querySelectorAll('.card');
  const prevBtn = document.getElementById('prev-btn');
  const nextBtn = document.getElementById('next-btn');
  let currentIndex = Math.floor(Math.random() * cards.length);

  // Function to show the current card
  function showCard(index) {
    cards.forEach((card, i) => {
      card.classList.remove('active');
      if (i === index) {
        card.classList.add('active');
      }
    });
  }

  // Handle Previous Button
  if (prevBtn) {
    prevBtn.addEventListener('click', () => {
      currentIndex = (currentIndex - 1 + cards.length) % cards.length;
      showCard(currentIndex);
    });
  }

  // Handle Next Button
  if (nextBtn) {
    nextBtn.addEventListener('click', () => {
      currentIndex = (currentIndex + 1) % cards.length;
      showCard(currentIndex);
    });
  }

  // Optionally: Auto switch cards every 5 seconds
  setInterval(() => {
    currentIndex = (currentIndex + 1) % cards.length;
    showCard(currentIndex);
  }, 5000);

  // 显示第一张卡片
  if (cards.length > 0) {
    showCard(currentIndex);
  }
}

document.addEventListener('DOMContentLoaded', () => {
  loadContent();
});
</script>
</html>